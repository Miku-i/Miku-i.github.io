{"ast":null,"code":"var _jsxFileName = \"/Users/miku/work/react/react-work/demo/src/components/register/index.js\";\nimport React, { Component } from \"react\";\nimport axios from 'axios';\nimport qs from \"qs\";\nimport \"./register.css\";\nimport { render } from \"react-dom\";\nimport { Link } from \"react-router-dom\";\nimport { AuthContext } from \"../../app\";\n\nclass Register extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      mobile: \"\",\n      // 手机号\n      password: \"\",\n      //密码\n      captcha_code: \"\",\n      //安全码内容\n      verify: \"\",\n      //手机验证码\n      display1: true,\n      display2: true,\n      captcha_key: \"\",\n      imgurl: \"\",\n      //验证码图片\n      time: \"60\"\n    };\n\n    this.verification = () => {\n      if (this.state.mobile.match(/^1\\d{10}/)) {\n        axios.get('http://jizhang-api-dev.it266.com/api/captcha') //记得要使⽤箭头函数\n        .then(response => {\n          console.log(response);\n          this.setState({\n            captcha_key: response.data.data.key,\n            imgurl: response.data.data.url\n          });\n        }).catch(error => {\n          console.log(error);\n        });\n      } else {\n        this.setState({\n          display1: false\n        });\n      }\n    };\n\n    this.sendout = () => {\n      console.log(this.state.captcha_key);\n      axios({\n        method: \"Post\",\n        url: \"http://jizhang-api-dev.it266.com/api/sms/verify\",\n        data: qs.stringify({\n          \"mobile\": this.state.mobile,\n          \"captcha_key\": this.state.captcha_key,\n          \"captcha_code\": this.state.captcha_code\n        })\n      }).then(item => {\n        console.log(item.data);\n\n        if (item.data.status) {\n          this.setState({\n            imgurl: \"\",\n            captcha_key: '',\n            display2: false,\n            time: 60\n          });\n          this.chang = setInterval(this.changeNum, 1000);\n        }\n      });\n    };\n\n    this.changeNum = () => {\n      let {\n        time,\n        display2\n      } = this.state;\n\n      if (time === 0) {\n        this.setState({\n          display2: true\n        });\n        return;\n      }\n\n      if (!display2) {\n        this.setState({\n          time: time - 1\n        });\n      }\n    };\n\n    this.register = () => {\n      if (this.state.mobile.match(/^1\\d{10}/)) {\n        axios({\n          method: \"Post\",\n          url: \"http://jizhang-api-dev.it266.com/api/user/register\",\n          data: qs.stringify({\n            \"mobile\": this.state.mobile,\n            \"verify\": this.state.verify,\n            \"password\": this.state.password\n          })\n        }).then(item => {\n          console.log(item.data);\n\n          if (item.data.data.token) {\n            window.localStorage.setItem('token', item.data.data.token);\n            window.localStorage.setItem('id', item.data.data.id);\n            window.location.href = 'http://localhost:3000/#/personal';\n          }\n        });\n      } else {\n        this.setState({\n          display1: false\n        });\n      }\n    };\n  }\n\n  render() {\n    return React.createElement(AuthContext.Consumer, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115\n      },\n      __self: this\n    }, val => {\n      console.log(val);\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        id: \"top\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120\n        },\n        __self: this\n      }, React.createElement(\"h4\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120\n        },\n        __self: this\n      }, \"\\u5B8C\\u5584\\u624B\\u673A\\u53F7\")), React.createElement(\"div\", {\n        id: \"please_register\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        id: \"wen\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122\n        },\n        __self: this\n      }, \"\\u4E3A\\u4E86\\u66F4\\u597D\\u7684\\u4F53\\u9A8C,\\u8BF7\\u4F60\\u7ACB\\u5373\\u5B8C\\u5584\\u624B\\u673A\\u53F7\")), React.createElement(\"div\", {\n        id: \"content\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"content-top\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127\n        },\n        __self: this\n      }, \"\\u624B\\u673A\\u53F7\\u5F52\\u5C5E\\u5730\"), React.createElement(\"span\", {\n        className: \"rg\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128\n        },\n        __self: this\n      }, \"\\u4E2D\\u56FD\")), React.createElement(\"div\", {\n        className: \"content-inp\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131\n        },\n        __self: this\n      }, \"+86\", React.createElement(\"input\", {\n        type: \"text\",\n        value: this.state.mobile,\n        onChange: e => {\n          this.setState({\n            mobile: e.target.value\n          });\n        },\n        placeholder: \"\\u8F93\\u5165\\u624B\\u673A\\u53F7\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133\n        },\n        __self: this\n      })), this.state.display1 ? \"\" : React.createElement(\"span\", {\n        className: \"tips\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142\n        },\n        __self: this\n      }, \"\\u8BF7\\u8F93\\u5165\\u6B63\\u786E\\u7684\\u624B\\u673A\\u53F7\"), React.createElement(\"div\", {\n        className: \"content-inp\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        type: \"text\",\n        value: this.state.verify,\n        onChange: e => {\n          this.setState({\n            verify: e.target.value\n          });\n        },\n        placeholder: \"\\u8F93\\u5165\\u9A8C\\u8BC1\\u7801\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144\n        },\n        __self: this\n      }), this.state.display2 ? React.createElement(\"button\", {\n        className: \"content-verificationCode\",\n        onClick: this.verification,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153\n        },\n        __self: this\n      }, \"\\u83B7\\u53D6\\u9A8C\\u8BC1\\u7801\") : React.createElement(\"div\", {\n        className: \"content-verificationCode\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158\n        },\n        __self: this\n      }, this.state.time)), React.createElement(\"div\", {\n        className: \"content-inp\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 161\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        type: \"text\",\n        value: this.state.password,\n        onChange: e => {\n          this.setState({\n            password: e.target.value\n          });\n        },\n        placeholder: \"\\u8BF7\\u8F93\\u5165\\u5BC6\\u7801\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162\n        },\n        __self: this\n      }))), React.createElement(\"button\", {\n        className: \"login\",\n        onClick: this.register,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172\n        },\n        __self: this\n      }, \"\\u6CE8\\u518C\"), this.state.imgurl ? React.createElement(\"div\", {\n        id: \"security\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 174\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"security-top\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175\n        },\n        __self: this\n      }, \"\\u5B89\\u5168\\u9A8C\\u8BC1\"), React.createElement(\"div\", {\n        className: \"security-content\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 176\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"security-img chex\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 177\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        src: this.state.imgurl,\n        alt: \"\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"exchange fl\",\n        onClick: this.verification,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183\n        },\n        __self: this\n      }, \"\\u6362\\u4E00\\u6362\"))), React.createElement(\"div\", {\n        className: \"content-inp\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        type: \"text\",\n        value: this.state.captcha_code,\n        onChange: e => {\n          this.setState({\n            captcha_code: e.target.value\n          });\n        },\n        placeholder: \"\\u8BF7\\u8F93\\u5165\\u9A8C\\u8BC1\\u7801\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186\n        },\n        __self: this\n      })), React.createElement(\"button\", {\n        className: \"login\",\n        onClick: this.sendout,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194\n        },\n        __self: this\n      }, \"\\u63D0\\u4EA4\"))) : ' '), React.createElement(\"div\", {\n        id: \"login\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 200\n        },\n        __self: this\n      }, React.createElement(\"li\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201\n        },\n        __self: this\n      }, React.createElement(Link, {\n        to: \"/login\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201\n        },\n        __self: this\n      }, \"\\u53BB\\u767B\\u5165\"))));\n    });\n  }\n\n}\n\nexport default Register;","map":{"version":3,"sources":["/Users/miku/work/react/react-work/demo/src/components/register/index.js"],"names":["React","Component","axios","qs","render","Link","AuthContext","Register","state","mobile","password","captcha_code","verify","display1","display2","captcha_key","imgurl","time","verification","match","get","then","response","console","log","setState","data","key","url","catch","error","sendout","method","stringify","item","status","chang","setInterval","changeNum","register","token","window","localStorage","setItem","id","location","href","val","e","target","value"],"mappings":"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","sourcesContent":["import React,{Component}from \"react\";\r\nimport axios from 'axios';\r\nimport qs from \"qs\"\r\nimport \"./register.css\"\r\nimport {render} from \"react-dom\";\r\nimport {Link} from \"react-router-dom\";\r\nimport {AuthContext} from \"../../app\";\r\n\r\n\r\nclass Register extends Component {\r\n    state={\r\n        mobile:\"\", // 手机号\r\n        password:\"\",//密码\r\n\r\n\r\n        captcha_code:\"\", //安全码内容\r\n        verify:\"\",  //手机验证码\r\n\r\n        display1:true,\r\n        display2:true,\r\n        captcha_key:\"\",\r\n        imgurl:\"\", //验证码图片\r\n\r\n\r\n        time:\"60\"\r\n    }\r\n\r\n    // 验证手机号获取安全码\r\n    verification = ()=>{\r\n        if(this.state.mobile.match(/^1\\d{10}/)){\r\n            axios.get('http://jizhang-api-dev.it266.com/api/captcha')\r\n                //记得要使⽤箭头函数\r\n                .then((response) => {\r\n                    console.log(response)\r\n                    this.setState({\r\n                        captcha_key: response.data.data.key,\r\n                        imgurl:response.data.data.url\r\n                    })\r\n                })\r\n                .catch((error)=>{\r\n                    console.log(error)\r\n                });\r\n        }else {\r\n            this.setState({display1:false})\r\n        }\r\n\r\n    }\r\n\r\n    // 验证安全码获取手机验证码\r\n    sendout = ()=>{\r\n        console.log(this.state.captcha_key)\r\n        axios({\r\n            method:\"Post\",\r\n            url:\"http://jizhang-api-dev.it266.com/api/sms/verify\",\r\n            data:qs.stringify({\r\n                \"mobile\" :this.state.mobile,\r\n                \"captcha_key\": this.state.captcha_key,\r\n                \"captcha_code\":this.state.captcha_code\r\n            })\r\n        }).then((item)=>{\r\n            console.log(item.data)\r\n            if(item.data.status){\r\n                this.setState({\r\n                    imgurl:\"\",\r\n                    captcha_key:'',\r\n                    display2:false,\r\n                    time:60\r\n                })\r\n                this.chang = setInterval(this.changeNum,1000);\r\n            }\r\n        })\r\n    }\r\n\r\n    changeNum=()=>{\r\n        let {time,display2}=this.state\r\n        if (time === 0) {\r\n            this.setState({ display2:true })\r\n            return;\r\n        }\r\n        if (!display2) {\r\n            this.setState({ time: time - 1 })\r\n        }\r\n\r\n    }\r\n\r\n    // 进行注册验证\r\n    register = ()=>{\r\n        if(this.state.mobile.match(/^1\\d{10}/)){\r\n            axios({\r\n                method:\"Post\",\r\n                url:\"http://jizhang-api-dev.it266.com/api/user/register\",\r\n                data:qs.stringify({\r\n                    \"mobile\" :this.state.mobile,\r\n                    \"verify\": this.state.verify,\r\n                    \"password\":this.state.password\r\n                })\r\n            }).then((item)=>{\r\n                console.log(item.data)\r\n                if(item.data.data.token){\r\n                    window.localStorage.setItem('token', item.data.data.token);\r\n                    window.localStorage.setItem('id', item.data.data.id);\r\n                    window.location.href = 'http://localhost:3000/#/personal';\r\n                }\r\n            })\r\n        }else {\r\n            this.setState({display1:false})\r\n        }\r\n\r\n\r\n    }\r\n\r\n\r\n    render() {\r\n        return (\r\n            <AuthContext.Consumer>\r\n                {(val)=>{\r\n                    console.log(val)\r\n                    return(\r\n                        <div>\r\n                            <div id=\"top\"><h4>完善手机号</h4></div>\r\n                            <div id=\"please_register\">\r\n                                <span id=\"wen\">为了更好的体验,请你立即完善手机号</span>\r\n                            </div>\r\n                            <div id=\"content\">\r\n                                <div>\r\n                                    <div className=\"content-top\">\r\n                                        <span>手机号归属地</span>\r\n                                        <span className=\"rg\">中国</span>\r\n                                    </div>\r\n\r\n                                    <div className=\"content-inp\">\r\n                                        +86\r\n                                        <input\r\n                                            type=\"text\"\r\n                                            value={this.state.mobile}\r\n                                            onChange={(e)=>{\r\n                                                this.setState({mobile:e.target.value})\r\n                                            }}\r\n                                            placeholder=\"输入手机号\"/>\r\n                                    </div>\r\n                                    {this.state.display1?\"\"\r\n                                        :<span className=\"tips\">请输入正确的手机号</span>}\r\n                                    <div className=\"content-inp\">\r\n                                        <input\r\n                                            type=\"text\"\r\n                                            value={this.state.verify}\r\n                                            onChange={(e)=>{\r\n                                                this.setState({verify:e.target.value})\r\n                                            }}\r\n                                            placeholder=\"输入验证码\"/>\r\n                                        {\r\n                                            this.state.display2?\r\n                                                <button\r\n                                                    className=\"content-verificationCode\"\r\n                                                    onClick={\r\n                                                        this.verification\r\n                                                    }\r\n                                                >获取验证码</button>:<div className=\"content-verificationCode\">{this.state.time}</div>\r\n                                        }\r\n                                    </div>\r\n                                    <div className=\"content-inp\">\r\n                                        <input\r\n                                            type=\"text\"\r\n                                            value={this.state.password}\r\n                                            onChange={(e)=>{\r\n                                                this.setState({password:e.target.value})\r\n                                            }}\r\n                                            placeholder=\"请输入密码\"/>\r\n                                    </div>\r\n\r\n                                </div>\r\n                                <button className=\"login\" onClick={this.register}>注册</button>\r\n                                {this.state.imgurl?\r\n                                    <div id=\"security\">\r\n                                        <div className=\"security-top\">安全验证</div>\r\n                                        <div className=\"security-content\">\r\n                                            <div className=\"security-img chex\">\r\n                                                <img src={this.state.imgurl} alt=\"\"/>\r\n                                                <div\r\n                                                    className=\"exchange fl\"\r\n\r\n                                                    onClick={this.verification}\r\n                                                ><span>换一换</span></div>\r\n                                            </div>\r\n                                            <div className=\"content-inp\">\r\n                                                <input\r\n                                                    type=\"text\"\r\n                                                    value={this.state.captcha_code}\r\n                                                    onChange={(e)=>{\r\n                                                        this.setState({captcha_code:e.target.value})\r\n                                                    }}\r\n                                                    placeholder=\"请输入验证码\"/>\r\n                                            </div>\r\n                                            <button className=\"login\" onClick={this.sendout}>提交</button>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    :' '}\r\n                            </div>\r\n                            <div id=\"login\"\r\n                            ><li><Link to=\"/login\">去登入</Link></li></div>\r\n\r\n                        </div>\r\n                    )\r\n                }}\r\n            </AuthContext.Consumer>\r\n\r\n        )\r\n    }\r\n}\r\n\r\n\r\nexport default Register;\r\n"]},"metadata":{},"sourceType":"module"}